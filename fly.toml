# OMEGA Cloud Nexus v4.0 - Fly.io Deployment
# See https://fly.io/docs/reference/configuration/

app = "openclaw-swarm-ai1976"
primary_region = "nrt" # Tokyo - closest to Taiwan

[build]
dockerfile = "Dockerfile.cloud"

[env]
NODE_ENV = "production"
OPENCLAW_PREFER_PNPM = "1"
OPENCLAW_STATE_DIR = "/data"
OPENCLAW_CONFIG_PATH = "/app/openclaw.json"
# 1024MB VM: 700MB for Node, ~100MB for Python Proxy, ~224MB OS/buffer
NODE_OPTIONS = "--max-old-space-size=700"
PROXY_PORT = "8001"
DEFAULT_GEMINI_MODEL = "gemini-2.0-flash"
OPENCLAW_LOG_LEVEL = "debug"
TZ = "Asia/Taipei"

[processes]
app = "/app/entrypoint.cloud.sh"

[http_service]
internal_port = 3000
force_https = true
auto_stop_machines = false # Keep running for persistent Telegram connections
auto_start_machines = true
min_machines_running = 1
processes = ["app"]

# Stateless hardening: 1024MB for Telegram plugin TypeScript compilation
[[vm]]
size = "shared-cpu-1x"
memory = "1024mb"

[mounts]
source = "openclaw_data"
destination = "/data"

